<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.j0n4than.ex.community.mappers.UserMapper">

    <insert id="insertBatch">
        INSERT INTO `con_user` (`username`, `pwd`, `salt`, `phone`, `email`, `sex`, `real_name`)
        VALUES
        <foreach collection="records" item="record" open="(" close=")" separator=",">
            #{record.username},
            #{record.pwd},
            #{record.salt},
            #{record.phone},
            #{record.email},
            #{record.sex},
            #{record.realName}
        </foreach>
    </insert>
    <update id="updateOne">
        UPDATE `con_user`
        <set>
            `username` = #{username},
            `phone` = #{phone},
            `email` = #{email},
            `sex` = #{sex},
            `real_name` = #{realName},
            <if test="pwd != null and pwd != ''">
                `pwd` = #{pwd},
            </if>
            <if test="salt != null and salt != ''">
                `salt` = #{salt},
            </if>
        </set>
        WHERE `id` = #{id}
    </update>
    <update id="switchStatus">
        UPDATE `con_user`
        SET `status` = !`status`
        WHERE id = #{id}
    </update>

    <select id="selectByUsername" resultType="cn.j0n4than.ex.community.pojo.entities.User">
        SELECT *
        FROM `con_user`
        WHERE username = #{username}
        LIMIT 1;
    </select>

    <select id="select" resultType="cn.j0n4than.ex.community.pojo.entities.User">
        SELECT *
        FROM `con_user`
        <where>
            <if test="username != null and username != ''">
                `username` LIKE '%${username}%'
            </if>
            <if test="email != null and email != ''">
                `email` LIKE '%${email}%'
            </if>
            <if test="sex != null and sex != 0">
                `sex` = #{sex}
            </if>
        </where>
    </select>

    <delete id="deleteByIds">
        DELETE FROM con_user WHERE id IN
        <foreach collection="ids" item="ids" separator="," open="(" close=")">
            #{ids}
        </foreach>
    </delete>


</mapper>
